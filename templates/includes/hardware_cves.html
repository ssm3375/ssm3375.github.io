<div id="cve-container">
  <h2>Available Hardware CVEs</h2>
  <div id="cve-list">Loading...</div>
  <div id="cve-details"></div>
</div>

<script>
  const API_BASE = "https://ssm3375-github-io.onrender.com";

  // Load file list from Flask
  fetch(`${API_BASE}/files`)
    .then(res => res.json())
    .then(files => {
      const listDiv = document.getElementById("cve-list");
      listDiv.innerHTML = "";  // clear "Loading..."
      files.forEach(file => {
        const link = document.createElement("a");
        link.href = "#";
        link.textContent = file;
        link.style.display = "block";
        link.onclick = () => loadCVE(file);
        listDiv.appendChild(link);
      });
    });

  // Load a single CVE file from Flask
  function loadCVE(filename) {
    fetch(`${API_BASE}/file/${filename}`)
      .then(res => res.json())
      .then(data => {
        const details = document.getElementById("cve-details");
        details.innerHTML = `
          <h3>${data.cve_id}</h3>
          <p><strong>Vendor:</strong> ${data.vendor}</p>
          <p><strong>Product:</strong> ${data.product}</p>
          <p><strong>Description:</strong> ${data.description}</p>
          <h4>References</h4>
          <ul>${data.references.map(url => `<li><a href="${url}" target="_blank">${url}</a></li>`).join("")}</ul>
        `;
      });
  }
</script>
